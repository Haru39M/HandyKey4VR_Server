<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HandyKey4VR Gesture Test</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='gesture.css') }}">
</head>
<body>
    <div class="container">
        <h1>Gesture Copy Task</h1>
        
        <!-- 設定エリア -->
        <div id="config-section" class="config-box">
            <div class="config-item">
                <label>ID: <input type="text" id="participant-id" value="p01"></label>
            </div>
            <div class="config-item">
                <label><input type="checkbox" id="debug-mode"> Debug</label>
            </div>
            <div class="config-item">
                <label>Hand: 
                    <select id="handedness">
                        <option value="" disabled selected>Select</option>
                        <option value="R">Right</option>
                        <option value="L">Left</option>
                    </select>
                </label>
            </div>
            <div class="config-item">
                <label>Cond: 
                    <select id="condition">
                        <option value="" disabled selected>Select</option>
                        <option value="Controller">Controller</option>
                        <option value="Proposed">Proposed</option>
                    </select>
                </label>
            </div>
            <div class="config-item">
                <label>Trials: <input type="number" id="max-trials" value="10" min="1"></label>
            </div>
            <button id="start-btn" disabled>START TEST</button>
        </div>

        <!-- テスト実行エリア -->
        <div id="test-section" style="display:none;">
            <div class="status-bar">
                <div id="progress-text">Trial: 0 / 10</div>
            </div>

            <div class="main-content">
                <!-- ターゲット画像・情報 -->
                <div class="left-panel">
                    <div class="img-wrapper">
                        <div id="overlay-message" class="overlay">
                            <span id="overlay-text">Ready...</span>
                        </div>
                        <img id="target-img" src="" alt="Target Gesture" style="display:none;">
                    </div>
                    <div id="target-name" class="gesture-name"></div>
                    <div id="target-desc" class="gesture-desc"></div>
                </div>

                <!-- 判定結果・プログレス -->
                <div class="center-panel">
                    <div class="result-box">
                        <div id="match-indicator" class="indicator mismatch">GO!</div>
                    </div>
                    <!-- ★追加: プログレスバー -->
                    <div id="match-progress-container">
                        <div id="match-progress-bar"></div>
                    </div>
                    <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Hold 0.5s</div>
                </div>

                <!-- 現在の手の状態（リアルタイム表示） -->
                <div class="right-panel">
                    <h2>Your Hand</h2>
                    <div class="fingers-container">
                        <div class="finger" id="f-T">
                            <div class="f-name">Thumb</div>
                            <div class="f-val">---</div>
                        </div>
                        <div class="finger" id="f-I">
                            <div class="f-name">Index</div>
                            <div class="f-val">---</div>
                        </div>
                        <div class="finger" id="f-M">
                            <div class="f-name">Middle</div>
                            <div class="f-val">---</div>
                        </div>
                        <div class="finger" id="f-R">
                            <div class="f-name">Ring</div>
                            <div class="f-val">---</div>
                        </div>
                        <div class="finger" id="f-P">
                            <div class="f-name">Pinky</div>
                            <div class="f-val">---</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="finished-screen" style="display:none;">
            <h2>TEST COMPLETED</h2>
            <button onclick="location.reload()">Return</button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='gesture.js') }}"></script>
</body>
</html>